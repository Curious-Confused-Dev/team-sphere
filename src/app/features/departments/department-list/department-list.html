<div class="overflow-x-auto">
  <h2 class="text-2xl font-bold mb-4 text-blue-700">Departments</h2>

  <div class="flex items-center mb-4 gap-2">
    <input type="text" placeholder="Search departments..." [(ngModel)]="searchTerm" (ngModelChange)="onSearch($event)" class="border rounded px-3 py-2 w-full max-w-xs focus:outline-none focus:ring-2 focus:ring-blue-400" />
    <button class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition">Add Department</button>
  </div>

  <app-table [columns]="['name', 'description', 'head', 'numEmployees', 'createdAt']" [data]="pagedDepartments" [actions]="[true]">
    <ng-template #actionsTemplate let-row>
      <button class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded shadow-sm transition" (click)="openView(row)">View</button>
      <button class="bg-gray-200 hover:bg-gray-300 text-gray-800 border border-gray-300 px-3 py-1 rounded shadow-sm ml-2 transition" (click)="openEdit(row)">Edit</button>
      <button class="bg-red-100 hover:bg-red-200 text-red-700 border border-red-300 px-3 py-1 rounded shadow-sm ml-2 transition" (click)="deleteDepartment(row)">Delete</button>
    </ng-template>
  </app-table>

  <div class="flex justify-between items-center mt-4">
    <div class="text-sm text-gray-600">
      Showing {{ (page - 1) * pageSize + 1 }}-
      {{ (page * pageSize < filteredDepartments.length ? page * pageSize : filteredDepartments.length) }}
      of {{ filteredDepartments.length }} departments
    </div>
    <div class="flex gap-1">
      <button (click)="setPage(page - 1)" [disabled]="page === 1" class="px-2 py-1 rounded border bg-white hover:bg-gray-100 disabled:opacity-50">Prev</button>
      <ng-container *ngFor="let p of [].constructor(totalPages); let i = index">
        <button (click)="setPage(i + 1)" [class.bg-blue-500]="page === i + 1" [class.text-white]="page === i + 1" class="px-2 py-1 rounded border hover:bg-blue-100" [disabled]="page === i + 1">{{ i + 1 }}</button>
      </ng-container>
      <button (click)="setPage(page + 1)" [disabled]="page === totalPages" class="px-2 py-1 rounded border bg-white hover:bg-gray-100 disabled:opacity-50">Next</button>
    </div>
  </div>

  <app-modal [open]="showModal" (closed)="closeModal()">
    <app-department-detail *ngIf="selectedDepartment" [department]="selectedDepartment" [mode]="modalMode" (close)="closeModal()" (save)="saveDepartment($event)"></app-department-detail>
  </app-modal>
</div>
